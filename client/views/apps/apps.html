<template name="apps">
<div class="container">
  <div class="row">
      <div class="col-sm-3">
        <h3><i class="glyphicon glyphicon-briefcase"></i> Toolbox</h3>
        <hr>

        <ul class="nav nav-stacked">
          {{#with appDefTemplate}}
          <li><a title="New App" href="#" data-toggle="modal" data-target="#editbox-{{hash}}"><i class="glyphicon glyphicon-plus"></i> New App</a></li>
          {{/with}}
        </ul>

        <hr>

      </div>

      {{> editAppDefBox appDefTemplate}}

      <div class="col-sm-9">
        <div class="row">
          <div class="col-md-8"><h3><i class="glyphicon glyphicon-dashboard"></i> Apps</h3></div>
          <div class="col-md-4">
            <div class="input-group align-with-header">
              <input type="text" id="searchField" class="form-control" placeholder="Search for..." value="{{searchTerms}}">
              <span class="input-group-btn">
                <button class="btn btn-default" type="button">Go!</button>
              </span>
            </div>
          </div>
        </div>
        <hr>

        <div class="row">
          <div class="col-md-12">

            {{#each apps}}
            <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a data-toggle="collapse" data-target="#appPanel-{{name}}"
                     href="#" class="collapsed toggle"><span class="badge">{{appDefCount}}</span> {{name}}</a>
                </h4>

              </div>
              <div id="appPanel-{{name}}" class="appPanel panel-collapse collapse">
                  <div class="panel-body">
                    <table class="table table-hover">
                      <tbody>
                        {{#each appDefs}}
                        <tr>
                          <th scope="row" style="width:250px; padding: 20px;">
                            {{version}}
                          </th>
                          <td style="padding: 20px;">
                            <div class="labelbox">
                              {{#each tags}}<span class="label label-info">{{this}}</span>{{/each}}
                            </div>
                          </td>
                          <td style="width: 100px;">
                            {{> appActions}}
                          </td>
                        </tr>
                        {{/each}}
                      </tbody>
                    </table>
                  </div>
              </div>
            </div>

            {{#each appDefs}}
            {{> editAppDefBox}}
            {{/each}}

            {{/each}}

            {{#if isSearching}}
            <div class="searchInfo">
              Showing results for: "{{searchTerms}}" <br />
              <button id="reset" type="button" class="btn btn-link">- reset -</button>
            </div>
            {{/if}}

          </div>

        </div>
      </div>

  </div>
</div>
</template>

<template name="appActions">
  <ul class="nav nav-justified">
    <li class="btn-group">

      <a title="Start" href="#" class="dropdown-toggle" data-toggle="dropdown">
        <i class="glyphicon glyphicon-play"></i>
      </a>
      <form role="form" class="dropdown-menu dropdown-menu-right" style="padding:1em">
          <div class="form-group" style="width:30em">
              <label>Instance name</label>
              <input required pattern="/?[a-zA-Z0-9_-]+" type="text"
                class="form-control instance-name" style="width:90%"
                placeholder="A unique name. Must match /?[a-zA-Z0-9_-]+."
                value="{{name}}">
              {{#each parameters}}
              <label>{{this}}</label>
              <input required type="text" class="form-control parameter" data-parameter="{{this}}" style="width:90%">
              {{/each}}
          </div>
          <button type="button" class="start-app btn btn-mini">Go!</button>
      </form>

    </li>
    <li><a title="Edit" href="#" data-toggle="modal" data-target="#editbox-{{hash}}"><i class="glyphicon glyphicon-cog"></i></a></li>
    <li class="btn-group">

      <a title="Remove" href="#" class="dropdown-toggle" data-toggle="dropdown">
        <i class="glyphicon glyphicon-trash"></i>
      </a>
      <form role="form" class="dropdown-menu dropdown-menu-right" style="padding:1em">
          <div class="form-group" style="width:20em">
            <div class="alert alert-warning" role="alert">
              <strong>Warning!</strong> Do you really want to remove this application?
            </div>
          </div>
          <button type="button" class="remove-app btn btn-mini btn-danger pull-right">Yes!</button>
      </form>
    </li>
  </ul>
</template>
